# Messaging Domain Entities
# Related entities for chat, messaging, and conversations

domain: messaging
description: Chat and messaging entities

entities:
  # ─────────────────────────────────────────────────────────────────────────────
  # Conversation - A thread of messages
  # ─────────────────────────────────────────────────────────────────────────────
  conversation:
    plural: conversations
    name: Conversation
    description: A thread of messages
    
    references:
      schema_org: https://schema.org/Conversation
      wikidata: Q4656145  # thread
    
    properties:
      id:
        type: string
        required: true
        description: Unique identifier
      
      name:
        type: string
        description: Group name or contact name
      
      last_message:
        type: string
        description: Preview of last message
      
      last_message_at:
        type: datetime
        description: When last message was sent
      
      unread_count:
        type: integer
        default: 0
        description: Number of unread messages
      
      avatar_url:
        type: string
        format: url
        description: Conversation avatar/photo
      
      is_group:
        type: boolean
        description: Whether this is a group conversation
      
      participant_count:
        type: integer
        description: Number of participants
      
      created_at:
        type: datetime
        description: When conversation was created
      
      updated_at:
        type: datetime
        description: When conversation was last updated
    
    operations: [list, get, create]
    
    display:
      primary: name
      secondary: last_message
      badge: unread_count
      icon: messages

  # ─────────────────────────────────────────────────────────────────────────────
  # Message - A single chat message
  # ─────────────────────────────────────────────────────────────────────────────
  message:
    plural: messages
    name: Message
    description: A chat message
    
    references:
      schema_org: https://schema.org/Message
      wikidata: Q628523  # message
    
    properties:
      id:
        type: string
        required: true
        description: Unique identifier
      
      conversation_id:
        type: string
        required: true
        description: Parent conversation ID
        references: conversation
      
      content:
        type: string
        required: true
        description: Message content
      
      sender:
        type: string
        required: true
        description: Sender name
      
      is_outgoing:
        type: boolean
        description: Whether message was sent by user
      
      timestamp:
        type: datetime
        required: true
        description: When message was sent
      
      status:
        type: string
        enum: [sending, sent, delivered, read, failed]
        description: Delivery status
      
      read:
        type: boolean
        default: false
        description: Whether message has been read
      
      read_at:
        type: datetime
        description: When message was read
      
      attachments:
        type: array
        description: Media attachments
      
      reactions:
        type: array
        description: Emoji reactions
    
    operations: [list, get, create]
    
    display:
      primary: content
      secondary: sender
      icon: message-circle

relationships:
  - from: message
    to: conversation
    type: belongs_to
    via: conversation_id
