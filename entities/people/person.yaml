# Person Entity - unified social graph node
# Unified across all platforms via the accounts array

id: person
plural: people
name: Person
description: Someone in your social graph, unified across platforms

references:
  schema_org: https://schema.org/Person
  wikidata: Q5

properties:
  id:
    type: string
    required: true
    description: Unique identifier

  # Display name (best known name for this person)
  name:
    type: string
    required: true
    description: Primary display name

  # Structured name fields (from Apple Contacts, vCard)
  first_name:
    type: string
    description: First/given name
  last_name:
    type: string
    description: Last/family name
  middle_name:
    type: string
    description: Middle name
  nickname:
    type: string
    description: Nickname or alias

  # Primary contact info (quick access)
  phone:
    type: string
    description: Primary phone (E.164 format)
  email:
    type: string
    format: email
    description: Primary email

  # Avatar references image entity
  avatar:
    references: image
    description: Primary profile photo

  # Work info
  organization:
    type: string
    description: Company or organization
  job_title:
    type: string
    description: Job title or role
  department:
    type: string
    description: Department within organization

  # Rich data
  birthday:
    type: date
    description: Birth date
  notes:
    type: string
    description: User notes about this person

  # Unified accounts array - the key innovation
  # All contact methods in one extensible array
  accounts:
    type: array
    description: All ways to reach or identify this person
    items:
      type: object
      required: [type, value]
      properties:
        type:
          type: string
          description: |
            Account type. Core: phone, email.
            Social: twitter, github, linkedin, instagram, facebook.
            Messaging: whatsapp, imessage, telegram, signal, slack.
            Any string allowed for extensibility.
        value:
          type: string
          description: The identifier (format depends on type)
        label:
          type: string
          description: Context like work, personal, home, old
        avatar:
          references: image
          description: Profile photo for this specific account
        source:
          type: string
          description: Where we learned about this account (apple-contacts, whatsapp, etc.)

  # Legacy fields (being replaced by accounts array)
  identities:
    type: array
    description: "[DEPRECATED] Cross-platform identities - use accounts instead"
    items:
      type: object
      properties:
        platform:
          type: string
        identifier:
          type: string

  sources:
    type: array
    description: Data sources that contribute to this entity
    items:
      type: object
      properties:
        plugin:
          type: string
        platform:
          type: string
        id:
          type: string

  created_at:
    type: datetime
    description: When first seen

  updated_at:
    type: datetime
    description: When last updated

# For cross-plugin deduplication
# Ordered by strength - try each until a match is found
identifiers:
  - phone
  - email

operations: [list, get, search]

display:
  primary: name
  secondary: organization
  icon: user
  show_as_app: true
  sort:
    - field: name
      order: asc
