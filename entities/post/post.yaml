# Post Entity
# A social media post, comment, or reply (Reddit, Twitter, HN, etc.)
#
# Extends document. Inherits:
#   From document: id, content, author, title, url, published_at, fetched_at, data
#
# Design principle: Comments ARE posts - just posts with a parent_id.
# This unifies the model across platforms while preserving tree structure.

id: post
plural: posts
extends: document
name: Post
description: A social media post, comment, or reply

references:
  schema_org: https://schema.org/SocialMediaPosting
  wikidata: Q7246757  # social media post

properties:
  # Post overrides url as required (every post has a permalink)
  url:
    type: string
    format: url
    required: true
    description: Permalink to the post (HN discussion, Reddit thread, etc.)

  external_url:
    type: string
    format: url
    description: External link target (the article being linked to, if any)

  community:
    references: community
    description: The community this was posted in

  engagement:
    type: object
    description: Engagement metrics
    properties:
      score:
        type: integer
        description: Net score (upvotes - downvotes) for Reddit, HN
      likes:
        type: integer
        description: Like count for Twitter, YouTube
      views:
        type: integer
        description: View count
      comment_count:
        type: integer
        description: Number of replies/comments
      shares:
        type: integer
        description: Retweets, reposts, shares

  parent_id:
    type: string
    description: Parent post/comment ID (null = top-level post)

  replies:
    type: array
    description: Nested reply tree (recursive post structure)
    items:
      type: post

  has_more_replies:
    type: boolean
    description: Whether there are more replies not included

operations: [list, search, get]

display:
  primary: title
  secondary: author.name
  description: content
  icon: message-square
  show_as_app: true
