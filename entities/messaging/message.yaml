# Message Entity
# A chat message — text sent from one person to another
#
# Extends writing. Inherits:
#   From writing: id, content, author (→ person)
#
# Vocabulary override: writing's `author` appears as `sender` here.
# "Who wrote this" and "who sent this" are the same concept in
# different contexts. The graph treats them as equivalent —
# querying "all writings by person X" finds messages too.
#
# NOT a document. Messages don't have titles, URLs, or publication
# semantics. They have delivery semantics (sent/delivered/read)
# and exist within conversations. Research: NEPOMUK and ActivityStreams
# both model messages as siblings of documents, not children.

id: message
plural: messages
extends: writing
name: Message
description: A chat message

references:
  schema_org: https://schema.org/Message
  wikidata: Q628523

vocabulary:
  author: sender

properties:
  # Override content as required (messages must have content)
  content:
    type: string
    required: true
    description: Message content

  # Vocabulary override of writing's `author` — same concept, messaging term.
  # The `vocabulary: { author: sender }` above tells the Rust resolver these
  # are the same field. This explicit declaration ensures JS validation works.
  sender:
    references: person
    description: Who sent this message

  conversation_id:
    type: string
    required: true
    description: Parent conversation ID
    references: conversation

  is_outgoing:
    type: boolean
    description: Whether message was sent by user

  timestamp:
    type: datetime
    required: true
    description: When message was sent

  status:
    type: string
    enum: [sending, sent, delivered, read, failed]
    description: Delivery status

  read:
    type: boolean
    default: false
    description: Whether message has been read

  read_at:
    type: datetime
    description: When message was read

  attachments:
    type: array
    description: Media attachments

  reactions:
    type: array
    description: Emoji reactions

operations: [list, get, create, search]

display:
  primary: content
  secondary: sender
  icon: message-circle
  show_as_app: true
